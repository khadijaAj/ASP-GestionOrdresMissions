
@model test_base_donnee_indemnite.Models.OrdreMission


<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>

        body {
            height: 14in;
            width: 9.25in;
            margin-left: auto;
            margin-right: auto;
            border: solid 1px;
        }


        .ecole {
            text-align: center;
            margin-left: 30px;
            width: 40%;
            font-size: small;
            font-weight: bold;
        }

        .img {
            margin-left: 300px;
            width: 200px;
            height: auto;
            align-content: center;
        }

        .header {
            display: flex;
            margin-top: 40px;
            margin-bottom: 50px;
        }

        .w {
            margin: 3px;
        }

        .title {
            text-align: center;
        }

        .info {
            display: flex;
        }

        .info1 {
            margin-left: 30px;
        }

        .info2 {
            margin-left: 250px;
            margin-top: 50px;
        }

        .table {
            text-align: center;
            width: 70%;
            margin-left: 130px;
            border-collapse: collapse;
        }

        .table1 {
            text-align: center;
            width: 100%;
            border-collapse: collapse 2px;
            border: 2px solid black;
        }

        .table2 {
            text-align: center;
            width: 84.6%;
            border-collapse: collapse;
        }




        .textLeft {
            text-align: left;
        }

        .textRight {
            text-align: right;
        }



        .borderStyle {
            border-style: dashed;
            width: 230px;
            height: 20px;
            padding-left: 30px;
        }

        .underTable {
            display: flex;
            margin-left: 100px;
            margin-right: 10px;
        }

        .prix {
            margin-left: 200px;
        }

        table, td {
            border-collapse: collapse;
            border: 2px solid black;
        }

        .tdExecpt {
            border: none;
        }

        .tdExecptLift {
            border-left: none;
        }

        .tdExecptRight {
            border-right: none;
        }

        .trExecptbottom {
            border-bottom: none;
        }

        .tdExecptTop {
            border-top: none;
        }

        h1 {
            font-family: "proxima-nova",sans-serif;
            letter-spacing: -0.01em;
            font-weight: 700;
            font-style: normal;
            font-size: 60px;
            margin-left: -3px;
            line-height: 1em;
            color: rgb(10, 5, 5);
            text-align: center;
            margin-bottom: 8px;
            text-rendering: optimizeLegibility;
        }

        .sectionGrille {
            padding: 40px;
            margin-left: auto;
            margin-right: auto;
            border: solid 1px;
        }

        .tableGrile {
            width: 100%;
        }

        .thClass {
            border-right: 2px solid black;
        }

        .paragraph {
            padding: 40px;
        }
    </style>

</head>
<body>


    <div class="header">
        <div class="ecole">
            <p class="w">UNIVERSITE CADI AYYAD</p>
            <p class="w">ECOLE NATIONAL DES SCIENCES APPLIQUEES</p>
            <p class="w">SAFI</p>
        </div>
        <div class="img"><img src="ensasLogo.png" alt="ensasLogo"></div>
    </div>
    <div class="title">
        <p> <b><u>ETAT DES INDEMNITES KILOMETRAGES OU DE</u></b> </p>
        <p><b><u> DEPLACEMENT</u></b></p>
    </div>
    <div class="info">
        <div class="info1">
            <p>M  :@Html.DisplayFor(model => model.numero) </p>
            <p>
                Effectués pendant le mois de :@ViewData["mois"]

            </p>
            <p>Nom & Prénom : @Html.DisplayFor(model => model.personel.Nom) @Html.DisplayFor(model => model.personel.Prenom) </p>
            <p>Echelle :@Html.DisplayFor(model => model.personel.Echelle)</p>
            <p>Groupe : @Html.DisplayFor(model => model.echlon)</p>
            <p>Motif de déplacement :   @Html.DisplayFor(model => model.objetDepart)</p>
        </div>
        <div class="info2">
            <p>Grade : @Html.DisplayFor(model => model.personel.Grades.Nom) </p>
            <p>Résidence :  @Html.DisplayFor(model => model.trajet.villeDepart)</p>
        </div>
    </div>
    <div>
        <table class="table ">
            <tbody>
                <tr class="trExecptbottom">
                    <td>
                        <table class="table1 tb1">
                            <tbody>
                                <tr>
                                    <td colspan="4" style="height: 60px;" class="textLeft">1°) Indemnités de déplacement</td>
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td class="textLeft">Nombre</td>
                                    <td class="textLeft">Taux</td>
                                    <td class="textLeft">Total</td>
                                </tr>
                                <tr>
                                    <td class="textLeft">Découcher</td>
                                    <td class="textRight">@ViewData["NbJourDecouche"]</td>
                                    <td class="textRight">@ViewData["taux"]</td>
                                    <td class="textRight">@ViewData["TolaleDecouche"]</td>
                                </tr>
                                <tr>
                                    <td class="textLeft">Repas de midi</td>
                                    <td class="textRight">@ViewData["NbRepasMidi"]</td>
                                    <td class="textRight">@ViewData["taux"]</td>
                                    <td class="textRight">@ViewData["TotaleRepasMidi"]</td>
                                </tr>
                                <tr>
                                    <td class="textLeft">Repas de soir</td>
                                    <td class="textRight">@ViewData["NbRepasSoir"]</td>
                                    <td class="textRight">@ViewData["taux"]</td>
                                    <td class="textRight">@ViewData["TotaleRepasSoir"]</td>
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td class="textLeft">S/TOTAL (I)</td>
                                    <td class="textRight">@ViewData["TotaleDeplacement"]</td>
                                </tr>
                                <tr>
                                    <td colspan="4" style="height: 60px;">
                                        <table class="table1  tdExecpt">
                                            <tbody>
                                                <tr><td colspan="4" class="textLeft tdExecpt">2°) Indemnités kilométriques</td></tr>
                                                <tr>
                                                    <td class="textLeft tdExecpt">@Html.DisplayFor(model => model.moyenTransport) :</td>
                                                    <td class="textLeft tdExecpt">@Html.DisplayFor(model => model.matricule)</td>
                                                    <td class="textLeft tdExecpt">Puissance</td>
                                                    <td class="tdExecpt">@Html.DisplayFor(model => model.nombreCheuvaux)</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td class="textLeft">Nombre</td>
                                    <td class="textLeft">Taux</td>
                                    <td class="textLeft">Total</td>
                                </tr>
                                <tr>
                                    <td class="textLeft">*Kms sur route</td>
                                    <td class="textRight">0</td>
                                    <td class="textRight">0</td>
                                    <td class="textRight">0</td>
                                </tr>
                                <tr>
                                    <td class="textLeft">*Kms sur route</td>
                                    <td class="textRight">&nbsp;</td>
                                    <td class="textRight">&nbsp;</td>
                                    <td class="textRight">&nbsp;</td>
                                </tr>
                                <tr>
                                    <td>&nbsp;</td>
                                    <td>&nbsp;</td>
                                    <td class="textLeft">S/TOTAL (I)</td>
                                    <td class="textRight">00.0</td>
                                </tr>
                            </tbody>
                        </table>
                        <!-- DivTable.com -->
                    </td>
                </tr>
                <tr class="tdExecptTop">
                    <td>
                        <table class="table1 tb1">
                            <tbody>
                                <tr>
                                    <td style="height: 30px;" class="textLeft tdExecpt">3°) Frais de tronsport</td>
                                    <td class="tdExecptLift"></td>
                                </tr>
                                <tr>
                                    <td colspan="4" class="textLeft">
                                        <table class="table1 tdExecpt">
                                            <tbody>
                                                <tr>
                                                    <td class="tdExecpt">&nbsp;</td>
                                                    <td class="tdExecpt">&nbsp;</td>
                                                    <td class="textLeft tdExecpt">Aller</td>
                                                    <td class="tdExecpt">&nbsp;</td>
                                                </tr>
                                                <tr>
                                                    <td class="tdExecpt">&nbsp;</td>
                                                    <td class="tdExecpt">&nbsp;</td>
                                                    <td class="textLeft tdExecpt">Retour</td>
                                                    <td class="tdExecpt">&nbsp;</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="tdExecpt">S/TOTAL (III)</td>
                                    <td class="tdExecptLift">00.0</td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
            </tbody>
            <table class="table2 tdExecpt">
                <tbody>
                    <tr>
                        <td colspan="3" class="tdExecpt">TOTAL(I+II+III)</td>
                        <td style="border:solid 3px; width: 150px;">@ViewData["TotaleDeplacement"]</td>
                    </tr>
                </tbody>
            </table>
        </table>
    </div>
    <br>
    <div class="underTable">
        <div>
            <p>Le Présent état s'élève à la somme de :</p>
        </div>
        <div class="prix">
            <pre class="borderStyle">@ViewData["TotaleDeplacement"]   dirhams, 00 cts</pre>
        </div>
    </div>
    <br><br>
    <div style="margin-left: 30px;">
        <p>Le bénéficaire atteste, n'avoir bénéficier d'aucune prise en charge total ou partielle de la part de la partie inviantante</p>
        <br><br><br>
        <p>Le sous ordonnateur soussigné, certifie l'exactitude des renseignements portés au présent état</p>
        <br>
        <div style="margin-left:630px;">
            <p>
                Safi, Le @ViewData["date"]
            </p>
        </div>

    </div>


    <br />
    <br /><br /><br /><br />
    <br /><br /><br /><br /><br />








                            <section class="sectionGrille">

                                <table class="tableGrile">
                                    <thead>
                                        <tr>
                                            <th rowspan="3" class="thClass">D<br>A<br>T<br>E</th>
                                            <th rowspan="3" class="thClass">INDICATION<br>DES<br>DEPLACEMENTS</th>
                                            <th colspan="4"><br><br><br></th>
                                            <th colspan="6"><br><br><br></th>

                                        </tr>
                                        <tr class="trExecptbottom">
                                            <td class=" tdExecptLift">HEURE</td>
                                            <td class="trExecptbottom">D</td>
                                            <td>D</td>
                                            <td>D</td>
                                            <td>&nbsp;&nbsp;</td>
                                            <td>&nbsp;&nbsp;</td>
                                            <td>&nbsp;&nbsp;</td>
                                            <td>&nbsp;&nbsp;</td>
                                            <td>&nbsp;&nbsp;</td>
                                            <td>OBSERVATIONS</td>
                                        </tr>


                                    </thead>

                                    <tbody>


                                        @{ int RepasMidi = ViewBag.nbRepasMidi;
                                            int RepasSoir = ViewBag.nbRepasSoir;
                                            int l = 0;
                                            int j = -1;
                                            int count = 0;

                                            for (int i = 1; i <= 31; i++)
                                            {
                                                                                <tr>
                                                                                    <td>@i</td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    @if (l < ViewBag.size)
                                                                                    {
                                                                                        if ((@ViewBag.listeGrille[l].jour == i))
                                                                                        {
                                                                                            <td style="text-align:center;">x</td>

                                                                                            if (@ViewBag.listeGrille[l].repasMidi == true)
                                                                                            {
                                                                                                <td style="text-align:center;">x</td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td></td>
                                                                                            }

                                                                                            if (@ViewBag.listeGrille[l].repasSoir == true)
                                                                                            {
                                                                                                <td style="text-align:center;">x</td>
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                                <td></td>
                                                                                            }

                                                                                            l++;

                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            <td></td>
                                                                                            <td></td>
                                                                                            <td></td>
                                                                                        }

                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        <td></td>
                                                                                        <td></td>
                                                                                        <td></td>
                                                                                    }



                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                    <td></td>
                                                                                </tr>
                                            }
                                        }
                                    </tbody>

                                </table>

                                <p class="paragraph">
                                    Indiquer le nombre (1) seulememnt dans les colonnes por les déjeuners(1114 à 1414), le repas du soir </br>
                                    (19H a 21H), le découcher (0H a 5H), indemnité de panier indemnité de tente.</br>
                                    Utliser des imprimés séparés selon qu'il s'agit des 30 premiers jours(100% de l'indemnité)</br>
                                    du 31 au 90éme jour(80% de l'indemnité)
                                </p>


                                @{

                                    foreach (var ele in @ViewBag.listeGrille)
                                    {
                                        <p> @ele.jour @ele.repasMidi @ele.repasSoir</p>
                                    }

                                    for (int m = 0; m < @ViewBag.size; m++)
                                    {
                                        @ViewBag.listeGrille[m].jour;
                                    }
                                    
                                    foreach (var ele in @ViewBag.listeJours)
                                    {
                                        <p> @ele</p>
                                    }
                                }
                            </section>


</body>

</html>


